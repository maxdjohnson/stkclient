"""Shared fixtures."""

from typing import Generator

import httpretty
import pytest


@pytest.fixture(autouse=True)
def disable_network_calls() -> Generator[None, None, None]:
    """Mocks network using httpretty."""
    httpretty.enable(verbose=True, allow_net_connect=False)
    yield
    httpretty.disable()  # disable afterwards, so that you will have no problems in code that uses that socket module
    httpretty.reset()  # reset HTTPretty state (clean up registered urls and request history)


@pytest.fixture()
def device_info() -> object:
    """Example DeviceInfo object."""
    from stkclient import model  # Import at top-level causes typeguard to fail

    return model.DeviceInfo.from_xml(DEVICE_INFO_XML.strip().encode())


DEVICE_INFO_XML = """
<?xml version="1.0" encoding="UTF-8"?>
<response><store_authentication_cookie>1Rq6uKVNO3yS+f5PtthBMV1NUrU5iMa9csg/OHU4/VamaYEGmYzMU2Vzt6UsOZh3idhqBZUi7aYUnjlbs9G+MqArtsWTQheQPfOF2L1mpwEBPeOyWSlgdvwxqdlFcxRIqbRf7Wid0ou8RUCGOLtWpxtYuZGe7v4Hsjwbt54fvCLT2FaQj9oqbQ1P4aZiIMyO</store_authentication_cookie><device_private_key>-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAvHAtTGD/eW+z2OA4+g6zwGbOM2SRAa4j2T0iLvGXfo+5cNSY
ML6ZdY+Jco6EFHSDgxzR9e9bcyQrLCS/MLhf8hKaaMAJ+7TFs9378Tq1+KcZtsDi
gU1391OzCLmXtjoiG4J/9PM9KLoZIifSsZHQLpz4SjmRkBmjtVHxz+y2/fM2GURa
DzTGWgRFD+Gn5Lazmju5+zpqQYyl/rAwm5aJY/CN5vsQ+GtXW5182xlPm7cZNoCC
fDaFy5hB4hmMKkzDH6429cTS2npOw9M3NuACyvY0ci5AivI+9mMrSqpUtzPmOXs1
Rn7h6dNOX6FWMILLGpoN2BHKJJOqSosW6O1btQIDAQABAoIBAQCzzEUsj5C0CgUM
dkVnMwgIGQ++scI6XDIQYehv6kymkfRa2D6uo+5A4cg/6gPUkKe7PpCHnO8hGe2n
nRhgIExL6bwzHqln5cCOMszmCyL+MlKysbBtt8Ez2EUHmi5LzYQlw4rb6gr9BTRe
BqlejMaa82NlTzC40f4GUD3uKusfun7Gnj3W7NrtZOCOTtNnhOCLInIiuKqC2Kak
xVfUqES8x3sRJsySwg963PaSOZHjHb/olc68WlST0SiCggZeAqc7Dg46xe5fBBkH
1jkynDtFJgTqjG2va4PAMTgrJyJTXBHxhJLH4RS9DBqhynJW7nc2ZB+GihpxOBod
bmGXmDkBAoGBAPUY80sLRgd8JhJzuXfH0G3FARcfea8OtgUWlwwWcI+/MEu4dYuY
Ca3UcmBDYUV8N1EncJi95g3rICeqn1ylX54LfFuFEb8JEpK4NP0bkeSFe3ltSwIE
rhjCkBBdTpPa17IC+8rkt2sfQ+wKtd/AtqvNqYYu8xmxS2uw0jOPVMERAoGBAMTS
BMNF+xXP3hubB5O7h2iZKtx6u3QIO4M6ayIF2Am0KNmnURyqF/7biKSxl4AwPIwU
7xlfCWC+5Fw6ah4Ybwf48MJEfBVaebLLHhmUzm4MOZik9Cz4bp1WFBUHyqBpFRh/
s+ogU44NYrJFDCGnjZM0IhuBUgoHGC9Q1RMTqjBlAoGBAN7WhXToVg4+GNtT7f9y
YxU6NUiRrG+131X2+PPbfxGikUV2+yAk5j/uVOMiv9COJDkbs6qblQt4h+6omWWB
UdL+vFz1OnJGzGUrJ7osE9QCbIW1EapPGP6X/qVyQBv7r3pAbi9FDWJOtdFo130M
2MiRHx1JmGr2oAzUYfjQyw0RAoGAeqXBEApgz5PL/Xna++VlGPoxalkUzNaAd2ME
9Zucp1dcCV2pPuqDr24QNUjxdpEYedZltHKzflUWKp7AF+bz8YzgQr64b/oEUjUe
maRQCuWVUpigDBH3pBXKx9wmGVXCLpUNgT0JtECFGz/JsoMdxvg6tNceT19iY8HE
NXIQoL0CgYBTRvfvpD/dURR+C71e3m9lO9p4Ujrq+dw8egMIpRA0xZqWq0Uu4IqX
tTrwis8p6GD/NeqwnI2p3s4Vu4XEu6+1QCW/3VYzrLiyQklYE3PKo62TFrO2icfa
Tc4WRiekzEvca7vfHZhyV9M862YPUHnRGD5cUm74BkJs6fe+0Kg1og==
-----END RSA PRIVATE KEY-----
</device_private_key><adp_token>{enc:RO6CkSjmVSIZJZNJv17YI1nhA0W5QrW3DiJ0SJtNelUX/XXu8VN5KBcMe61E3EaY6YHUJFE8GYjRQSd2npAhRLox5Thq480f7opOHGlXhxvgPUiNiOIjLhJvV4yWby2nS8yrBK2fM2e7koVQTgRhgO+Q8kS2S/Vwew00E/BtnbQadRJRXzf9nzaeoqlU5L+renYnpNn1zrnOWpK9iYlNaAfIavVTy+Msy9bm12ttk6conNnvEhZWqNj1GcCL0BkuSwgQepwHgIc+qlsQtMKmRjXEczZ3ly3S0VuXhMeymJ1K+ctxhHRN4FgUynUAG85l8VF3AXzGgel+0i/E5MeJsqu0j4vGD/scTHv9NVYWzk8XQYAL0A9KbUHfCM3yixLLr1eJ8NCrw6Xaz3hthgpB/A6BZwEzu3V+RjYHDL+MIi1X8+0V5Dha/QLvoWWjooZr7WO447O3SQBgPGYQnKmq4jnyixzTtEN7HSduFy6p00od0pmdxCrR0op65CQT5OJvgdjgPLLBmDvWvxrh1OjYgUXLbCGc8TtNI6+I6h3crz7K9IEytztwNfSDKYOvTP3pZN2MknRMIZpcR4xNIN1992aw/kpE2TQl8gG08bXf5boJToJrs+e85IdsSX4u8/I/7GnRb2+lsvmOOVXzIiTWI/fONqUWmHHzuQcdQtLbowsvAp76gJlajjsRHG9O19/97fO4QG79BQTJMeF5dPqtGpCnsOOyYzvvz7BvaFG5zWBAkzUV1XH2kAJXJ9ePPsbbhhH13IeBItmWsZKUOyDe6MPVCz6czzZxIDVCSVmUESNP4f5Q9vup4DE8sUWnAvlLlrna4VfyUWdBgym4qIOuCJfTUipVj/yCIs2cX6BG638Gf+56WXRXMjFHLw0M4nkRI/iyopEWUi8oz8HLgmk80GUTsOCWDe+UZSfY2xM7AOdA4jGwFmGAWvJayYJIIak3AZhK7K1PWhGhBrbGhmI37Us3VPdrzWIrVfNqATwXYg9rhrobQvl0nO/HoUc6yQLRp/H2f/RXdpFiE2U5YmcwtwoajcJcaP+LrKN0nEizXS+wDJA4hEP764DSBz5TzIDP}{key:hfc6hJP0yu+K4rUrBDNHxEMnJ4caIap/DxaJhSv4a6Oy/l1WKYd6lfhjvAFG5+8Xce0tfYLFKBZzHE1GWz1BE3VARCiSI03Fkt4F9ZDcSohe/XNWokC/kuAw1L3JRAN/kZ8hk+wt7LKAmWS35eIemKQ1Fh7AvlPc0i+rd/JTY1eKMbQvwxiwDAtnX56boOI4e+cpmAYdwYR1aLRypkEEVfUaQnGqQ8mdsrBveWTNeoPBr7oY/oXdGa3X4ceZqTEQCUyWkUjA6iN/g07oTaJ0RtbkINieIxD+yfDTdY/qlyX2LNJfVtuKhVFOjC3eogiYu6NF/IphIXmC+UM40hwVbQ==}{iv:rB7gMOt3y40wwbJanaHILQ==}{name:QURQVG9rZW5FbmNyeXB0aW9uS2V5}{serial:Mg==}</adp_token><device_type>A3VNNDO1I14V03</device_type><given_name>Patrick</given_name><name>Patrick Browne</name><account_pool>Amazon</account_pool><country_of_residence>FR<source_of_cor>CUSTOMER_ADDRESS</source_of_cor></country_of_residence><preferred_marketplace>A13V1IB3VIYZZH</preferred_marketplace><user_directed_id>amzn1.account.AGR5QVVM3IR5IXV2CDLYSNSOC7FA</user_directed_id><user_device_name>Patrick's 2nd Android Phone</user_device_name></response>
"""
